import{_ as i,c as a,a3 as e,o as t}from"./chunks/framework.BOyF8YV7.js";const p=JSON.parse('{"title":"完善的CDN管理系统：用户系统、计费、接口文档及SDK开发","description":"本文档介绍了一个完善的用户系统，包括子用户及权限管理、预付费和后付费的计费系统，以及与百度和腾讯CDN的整合方案。此外，还涵盖了接口文档编写、数据库设计、CDN厂商管理、数据统计、日志管理、SDK开发等方面的内容，旨在提升系统易用性和自动化运维能力。","frontmatter":{"head":[["link",{"rel":"canonical","href":"https://blog.ranchulin.com/t/Openresty/CDN系统重构.html"}],["meta",{"property":"og:title","title":"完善的CDN管理系统：用户系统、计费、接口文档及SDK开发"}],["meta",{"property":"og:url","content":"https://blog.ranchulin.com/t/Openresty/CDN系统重构.html"}],["meta",{"name":"keywords","content":"用户系统,子用户,权限管理,RBAC,CDN,百度CDN,腾讯CDN,接口文档,自动化管理,计费,预付费,后付费,微信支付,支付宝支付,账单,数据统计,日志管理,SDK,PHP,Java,域名管理,SSL证书,缓存管理,WAF,数据迁移"}]]},"headers":[],"relativePath":"t/Openresty/CDN系统重构.md","filePath":"t/Openresty/CDN系统重构.md","lastUpdated":1736299776000}'),r={name:"t/Openresty/CDN系统重构.md"};function o(u,l,n,h,d,c){return t(),a("div",null,l[0]||(l[0]=[e('<blockquote><p>我们需要的是 完善的用户系统，子用户及相关权限，然后 预付费 后付费的扣费，我们目前是融合的百度的 CDN，后续可能会考虑融合腾讯的，这样的话两个 CDN 平台怎么做一个整合</p></blockquote><h2 id="接口文档编写" tabindex="-1">接口文档编写 <a class="header-anchor" href="#接口文档编写" aria-label="Permalink to &quot;接口文档编写&quot;">​</a></h2><blockquote><p>自己知道有这些流程即可，员工流动性不可控，方便维护交接</p></blockquote><ul><li>自动化管理接口文档</li><li>通用结构定义</li><li>功能模块开发 <ul><li>数据库设计（用户表、配置表等怎么设计）</li><li>依赖的数据结构（比如用到了 Redis、消息中间件之类的）</li><li>逻辑编写（如何实现的，怎么实现的，数据怎么查 SQL，数据走向等）</li></ul></li></ul><h2 id="用户系统" tabindex="-1">用户系统 <a class="header-anchor" href="#用户系统" aria-label="Permalink to &quot;用户系统&quot;">​</a></h2><h3 id="子用户系统" tabindex="-1">子用户系统 <a class="header-anchor" href="#子用户系统" aria-label="Permalink to &quot;子用户系统&quot;">​</a></h3><ul><li>添加子账号（子账号不允许注册） <ul><li>余额、账单金额</li><li>各类指标：流量、域名数量、使用流量</li></ul></li><li>根据功能模块创建角色 <ul><li>Rbac 权限管理，用户 - 角色 - 权限控制，参考<a href="http://www.woshipm.com/pd/1150093.html" target="_blank" rel="nofollow noopener noreferrer">http://www.woshipm.com/pd/1150093.html</a></li></ul></li><li>角色开通接口权限，下发签名秘钥等</li></ul><h2 id="cdn-厂商" tabindex="-1">CDN 厂商 <a class="header-anchor" href="#cdn-厂商" aria-label="Permalink to &quot;CDN 厂商&quot;">​</a></h2><ul><li>一处添加，多处使用 <ul><li>厂商的管理，其实就是规则的管理，哪些域名在哪个厂商下，哪个配置在哪个厂商下</li></ul></li><li><code>CDN厂商提供的接口其实差不多，代码层面上确定好interface（接口）</code>，功能如下 <ul><li>域名管理 <ul><li>添加、修改、删除域名</li></ul></li><li>SSL 证书管理 <ul><li>SSL 证书，上传、删除、创建免费证书</li></ul></li><li>缓存管理 <ul><li>刷新 CDN，删除缓存</li><li>设置规则</li></ul></li><li>WAF 管理</li><li>日志下载、统计数据查询</li></ul></li></ul><h2 id="计费" tabindex="-1">计费 <a class="header-anchor" href="#计费" aria-label="Permalink to &quot;计费&quot;">​</a></h2><ul><li>预付费 <ul><li>微信支付</li><li>支付宝支付</li></ul></li><li>按量计费 <ul><li>钱包充值</li></ul></li><li>账单 <ul><li>预付费账单</li><li>每月按量后付费账单 <ul><li>账单支付状态管理</li><li>可充值、可支付</li></ul></li></ul></li></ul><h2 id="数据统计" tabindex="-1">数据统计 <a class="header-anchor" href="#数据统计" aria-label="Permalink to &quot;数据统计&quot;">​</a></h2><ul><li>Top5 IP</li><li>流量消耗曲线图</li><li>Top10 URL</li><li>错误统计、状态码统计等</li></ul><h2 id="日志管理" tabindex="-1">日志管理 <a class="header-anchor" href="#日志管理" aria-label="Permalink to &quot;日志管理&quot;">​</a></h2><ul><li>归档日志下载 <ul><li>统一定义好日志结构，方便清洗</li></ul></li><li>日志查询（可延迟）</li></ul><h2 id="商务合作-接口-sdk-开发" tabindex="-1">商务合作，接口 SDK 开发 <a class="header-anchor" href="#商务合作-接口-sdk-开发" aria-label="Permalink to &quot;商务合作，接口 SDK 开发&quot;">​</a></h2><p>为了吸引开发，方便客户自动化运维，考虑开放部分接口方便客户自动管理自己的 CDN，制定接口签名规则</p><h3 id="sdk-类型" tabindex="-1">SDK 类型 <a class="header-anchor" href="#sdk-类型" aria-label="Permalink to &quot;SDK 类型&quot;">​</a></h3><ul><li>PHP</li><li>Java</li></ul><h3 id="功能" tabindex="-1">功能 <a class="header-anchor" href="#功能" aria-label="Permalink to &quot;功能&quot;">​</a></h3><ul><li>刷新 CDN <ul><li>缓存预取</li></ul></li><li>归档日志下载</li><li>域名管理 <ul><li>添加</li><li>修改</li><li>删除</li><li>SSL 证书管理</li></ul></li><li>白名单，黑名单添加</li><li>统计数据查询</li></ul><h2 id="数据迁移" tabindex="-1">数据迁移 <a class="header-anchor" href="#数据迁移" aria-label="Permalink to &quot;数据迁移&quot;">​</a></h2><ul><li>老服务用户数据迁移 <ul><li>结构的调整</li></ul></li></ul>',23)]))}const m=i(r,[["render",o]]);export{p as __pageData,m as default};
